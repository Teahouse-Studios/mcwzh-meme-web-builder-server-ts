ROSTemplateFormatVersion: "2015-09-01"
Transform: "Aliyun::Serverless-2018-04-03"
Resources:
  meme-server:
    Type: "Aliyun::Serverless::Service"
    Properties:
      Description: MEME
      VpcConfig:
        VpcId: 
        VSwitchIds: [""]
        SecurityGroupId: 
      NasConfig: 
        UserId: -1
        GroupId: -1
        MountPoints:
          - ServerAddr: ':/meme-nas'
            MountDir: '/mnt/meme'
    meme-server:
      Type: "Aliyun::Serverless::Function"
      Properties:
        Handler: index.handler
        Runtime: custom
        CodeUri: ./
        MemorySize: 256
        InstanceConcurrency: 10
        Timeout: 30

        EnvironmentVariables:
          BOOTSTRAP_FILE: bootstrap

      Events:
        httpTrigger:
          Type: HTTP
          Properties:
            AuthType: ANONYMOUS
            Methods: ["GET","POST"]
  Domain:
    Type: Aliyun::Serverless::CustomDomain
    Properties:
      DomainName: 
      Protocol: HTTP,HTTPS
      CertConfig:
        CertName: ""
        PrivateKey: ""
        Certificate: ""
      RouteConfig:
        Routes:
          "/*":
            ServiceName: meme-server
            FunctionName: meme-server